% -----------------------------------------------------------------------------
\section{Description of outputs}
The results generated by the OpenQuake-engine are fundamentally 
of two distinct typologies differentiated by the presence (or 
absence) of epistemic uncertainty in the PSHA input model.

When epistemic uncertainty is incorporated into the 
calculation, the Open\-Quake\--engine calculators (e.g. Classical 
PSHA, Event Based PSHA, Disaggregation, UHS) produce a 
set of results (i.e. hazard curves, ground motion fields, 
disaggregation matrices, UHS, for each logic-tree realisation) 
which reflects epistemic 
uncertainties introduced in the PSHA input model.

For each logic tree sample, results are computed and stored. 
Calculation of results statistics (mean, standard deviation, 
quantiles) are supported by all the calculators with the exception 
of the disaggregation one.
% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
\subsection{Output from Classical PSHA}
By default, the classical PSHA calculator computes and stores 
hazard curves for each logic tree sample considered.

When the PSHA input model doesn't contain epistemic uncertainties
the results is a set of hazard curves (one for each 
investigated site). 
The command below illustrates how is possible to retrieve the group
of hazard curves obtained for a calculation with a given
identifier \texttt{<calc\_id>} (see Section \ref{sec:getting_results}
for an explanation about how to obtain the list of calculations 
performed with their corresponding ID):
\begin{Verbatim}[frame=single, commandchars=\\\{\}, fontsize=\small]
user@ubuntu:~$ openquake --lho <calc_id>
id | output_type | name
\textcolor{red}{3 | hazard_curve | hc-rlz-6}
\end{Verbatim}
In this case the \gls{acr:oqe} computed a group of hazard curves with 
result ID equal to \texttt{3}.
 
On the contrary, if the parameter \texttt{number\_of\_logic\_tree\_samples}
in the configuration file is different than zero, then N hazard curves files 
are generated. The example below shows this case:
\begin{Verbatim}[frame=single, commandchars=\\\{\}, fontsize=\small]
user@ubuntu:~$ openquake --lho <calc_id>
id | output_type | name
\textcolor{red}{5 | hazard_curve | hc-rlz-10}
\textcolor{red}{6 | hazard_curve | hc-rlz-7}
\textcolor{red}{7 | hazard_curve | hc-rlz-8}
\textcolor{red}{8 | hazard_curve | hc-rlz-9}
\textcolor{red}{9 | hazard_curve | hc-rlz-11}
\textcolor{red}{10 | hazard_curve | hc-rlz-12}
\end{Verbatim}
If we export from the database the hazard curves contained in 
one of the items above using the following command
\begin{Verbatim}[frame=single, commandchars=\\\{\}, fontsize=\small]
user@ubuntu:~$ openquake --eh <output_id> <output_directory>
\end{Verbatim}
we obtain a nrml formatted file as represented in the example
in the inset below.
\begin{Verbatim}[frame=single, commandchars=\\\{\}, fontsize=\small]
<?xml version='1.0' encoding='UTF-8'?>
<nrml xmlns:gml="http://www.opengis.net/gml" 
      xmlns="http://openquake.org/xmlns/nrml/0.4">
  <hazardCurves \textcolor{red}{sourceModelTreePath="b1|b212"} 
      \textcolor{red}{gsimTreePath="b2" IMT="PGA" investigationTime="50.0"}>
    \textcolor{green}{<IMLs>0.005 0.007 0.0098 ... 1.09 1.52 2.13</IMLs>}
    <hazardCurve>
      <gml:Point>
      \textcolor{blue}{<gml:pos>10.0 45.0</gml:pos>}
      </gml:Point>
      <poEs>1.0 1.0 1.0 ... 0.000688359310522 0.0 0.0</poEs>
    </hazardCurve>
    ...
    <hazardCurve>
      <gml:Point>
      \textcolor{blue}{<gml:pos>lon lat</gml:pos>}
      </gml:Point>
      <poEs>poe1 poe2 ... poeN</poEs>
    </hazardCurve>
  </hazardCurves>
</nrml>
\end{Verbatim}
Not\-with\-stand\-ing the intuitiveness of this file, let's have a brief 
overview of the information included.

The overall content of this file is a list of hazard curves, one for
each investigated site, computed using a PSHA input model representing
one possible realisation obtained using the complete logic tree structure. 

The attributes of the \texttt{hazardCurves} element (see text in 
red) specify the path of the logic tree 
used to create the seismic source model (\texttt{source\-Model\-TreePath}) 
and the ground motion model (\texttt{gsim\-Tree\-Path}) plus the 
intensity measure type and the investigation time used to compute 
the probability of exceedance. 

The \texttt{IMLs} element (in green in the example) contains the 
values of shaking used by the engine to compute the probability of 
exceedance in the investigation time.
For each site this file contains a \texttt{hazardCurve} element which 
has the coordinates (longitude and latitude in decimal degrees) 
of the site and the values of the probability of exceedance for all the 
intensity measure levels specified in the \texttt{IMLs} element.

If in the configuration file the calculation of mean hazard curves 
and hazard curves corresponding to one or several percentiles have 
been specified, the list of outputs that we should expect from the 
OpenQuake-engine corresponds to:
\begin{Verbatim}[frame=single, commandchars=\\\{\}, fontsize=\small]
user@ubuntu:~$ openquake --lho <calc_id> 
id | output_type | name
17 | hazard_curve | hc-rlz-17
18 | hazard_curve | hc-rlz-18
19 | hazard_curve | hc-rlz-13
20 | hazard_curve | hc-rlz-14
21 | hazard_curve | hc-rlz-15
22 | hazard_curve | hc-rlz-16
\textcolor{red}{23 | hazard_curve | quantile(0.5)-curves-PGA}
24 | hazard_map | hazard-map(0.1)-PGA-rlz-17
25 | hazard_map | hazard-map(0.1)-PGA-rlz-18
26 | hazard_map | hazard-map(0.1)-PGA-rlz-13
27 | hazard_map | hazard-map(0.1)-PGA-rlz-14
28 | hazard_map | hazard-map(0.1)-PGA-rlz-15
29 | hazard_map | hazard-map(0.1)-PGA-rlz-16
\textcolor{red}{30 | hazard_map | hazard-map(0.1)-PGA-quantile(0.5)}
\end{Verbatim}
In this example the \gls{acr:oqe} produced hazard curves and hazard maps for 
six logic tree realisations plus median hazard curves 
and the median hazard map (both highlighted in red).

The following inset shows a sample of the nrml file used 
to describe a hazard map.
\begin{Verbatim}[frame=single, commandchars=\\\{\}, fontsize=\small]
<?xml version='1.0' encoding='UTF-8'?>
<nrml xmlns:gml="http://www.opengis.net/gml" 
      xmlns="http://openquake.org/xmlns/nrml/0.4">
  \textcolor{red}{<hazardMap sourceModelTreePath="b1" gsimTreePath="b1"}
        \textcolor{red}{IMT="PGA" investigationTime="50.0" poE="0.1">}
    <node lon="119.596690957" lat="21.5497682591" iml="0.204569990197"/>
    <node lon="119.596751048" lat="21.6397004197" iml="0.212391638188"/>
    <node lon="119.596811453" lat="21.7296325803" iml="0.221407505615"/>
    ...
  </hazardMap>
</nrml>
\end{Verbatim}
